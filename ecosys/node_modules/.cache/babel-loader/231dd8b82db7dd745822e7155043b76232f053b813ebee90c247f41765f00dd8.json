{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"leaflet/dist/leaflet.css\";\nimport $L from \"leaflet\";\nconst createMap = (divId, options) => {\n  let map = $L.map(divId, options);\n  return map;\n};\nconst createTileLayer = async (map, url, options) => {\n  let tileLayer = await $L.tileLayer(url, options);\n  tileLayer.addTo(map);\n  return tileLayer;\n};\n\n/*------------------------\r\n* 生态文明数据展示系统——地图\r\n--------------------------*/\nexport class DataShowMap {\n  constructor(mapContainer) {\n    // const tianDituVec = $L.tileLayer(\n    //   \"http://t0.tianditu.gov.cn/vec_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=vec&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=fa0125f3e4d72a075c8d2f56acf7b13d\"\n    // );\n    // const tianDituVecAnnotion = $L.tileLayer(\n    //   \"http://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=fa0125f3e4d72a075c8d2f56acf7b13d\"\n    // );\n    const mapboxTiles = L.tileLayer(\"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiMTAxODAxMjVjeXoiLCJhIjoiY2x2YThibjNxMHl4dTJ3anpwNzJjaml2ZiJ9.NH-fFCfIqsducsa7aVxAPw\", {\n      id: \"mapbox/streets-v11\",\n      // 设置地图样式，可以根据需求选择其他样式，比如 'mapbox/satellite-v9'\n      accessToken: accessToken,\n      tileSize: 512\n    });\n    this.map = createMap(mapContainer, {\n      // layers: osm,\n      layers: [tianDituVec, tianDituVecAnnotion],\n      minZoom: 2,\n      zoom: 4,\n      center: [35.42, 102.05],\n      maxBounds: $L.latLngBounds($L.latLng(-90, -160), $L.latLng(90, 200))\n    });\n    this.layers = [];\n  }\n\n  /*\r\n   * layerUrl: 新的底图url\r\n   * isWMS: 是不是WMS服务，不是的话为WMTS服务\r\n   * function: 根据新的底图url切换底图\r\n   */\n  toggleLayerShow(layerId, layerService, isShow, layerType) {\n    if (isShow) {\n      let layer;\n      if (layerType === \"wms\") {\n        layer = $L.tileLayer.wms(layerService.url, {\n          layers: layerService.layers,\n          format: layerService.format,\n          transparent: true,\n          crs: $L.CRS.EPSG3857,\n          // zoomOffset:2,\n          zIndex: 99\n        });\n      }\n      this.layers.push({\n        id: layerId,\n        layer: layer\n      });\n      layer.addTo(this.map);\n    } else {\n      let index = 0;\n      for (const layer of this.layers) {\n        if (layer.id === layerId) {\n          this.map.removeLayer(layer.layer);\n          this.layers.splice(index, 1);\n          break;\n        }\n        index++;\n      }\n    }\n  }\n\n  // 组件销毁时调用，否则可能导致刷新空白等错误\n  destroy() {\n    this.map && this.map.remove();\n  }\n}\nexport default {\n  createMap,\n  createTileLayer\n};","map":{"version":3,"names":["$L","createMap","divId","options","map","createTileLayer","url","tileLayer","addTo","DataShowMap","constructor","mapContainer","mapboxTiles","L","id","accessToken","tileSize","layers","tianDituVec","tianDituVecAnnotion","minZoom","zoom","center","maxBounds","latLngBounds","latLng","toggleLayerShow","layerId","layerService","isShow","layerType","layer","wms","format","transparent","crs","CRS","EPSG3857","zIndex","push","index","removeLayer","splice","destroy","remove"],"sources":["E:/Working/IP_proj/EcosystemCivi/ecosys/src/utils/map.js"],"sourcesContent":["import \"leaflet/dist/leaflet.css\";\r\nimport $L from \"leaflet\";\r\n\r\nconst createMap = (divId, options) => {\r\n  let map = $L.map(divId, options);\r\n  return map;\r\n};\r\n\r\nconst createTileLayer = async (map, url, options) => {\r\n  let tileLayer = await $L.tileLayer(url, options);\r\n  tileLayer.addTo(map);\r\n  return tileLayer;\r\n};\r\n\r\n/*------------------------\r\n* 生态文明数据展示系统——地图\r\n--------------------------*/\r\nexport class DataShowMap {\r\n  constructor(mapContainer) {\r\n    // const tianDituVec = $L.tileLayer(\r\n    //   \"http://t0.tianditu.gov.cn/vec_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=vec&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=fa0125f3e4d72a075c8d2f56acf7b13d\"\r\n    // );\r\n    // const tianDituVecAnnotion = $L.tileLayer(\r\n    //   \"http://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=fa0125f3e4d72a075c8d2f56acf7b13d\"\r\n    // );\r\n    const mapboxTiles = L.tileLayer(\r\n      \"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiMTAxODAxMjVjeXoiLCJhIjoiY2x2YThibjNxMHl4dTJ3anpwNzJjaml2ZiJ9.NH-fFCfIqsducsa7aVxAPw\",\r\n      {\r\n        id: \"mapbox/streets-v11\", // 设置地图样式，可以根据需求选择其他样式，比如 'mapbox/satellite-v9'\r\n        accessToken: accessToken,\r\n        tileSize: 512,\r\n      }\r\n    );\r\n    this.map = createMap(mapContainer, {\r\n      // layers: osm,\r\n      layers: [tianDituVec, tianDituVecAnnotion],\r\n      minZoom: 2,\r\n      zoom: 4,\r\n      center: [35.42, 102.05],\r\n      maxBounds: $L.latLngBounds($L.latLng(-90, -160), $L.latLng(90, 200)),\r\n    });\r\n    this.layers = [];\r\n  }\r\n\r\n  /*\r\n   * layerUrl: 新的底图url\r\n   * isWMS: 是不是WMS服务，不是的话为WMTS服务\r\n   * function: 根据新的底图url切换底图\r\n   */\r\n  toggleLayerShow(layerId, layerService, isShow, layerType) {\r\n    if (isShow) {\r\n      let layer;\r\n      if (layerType === \"wms\") {\r\n        layer = $L.tileLayer.wms(layerService.url, {\r\n          layers: layerService.layers,\r\n          format: layerService.format,\r\n          transparent: true,\r\n          crs: $L.CRS.EPSG3857,\r\n          // zoomOffset:2,\r\n          zIndex: 99,\r\n        });\r\n      }\r\n      this.layers.push({\r\n        id: layerId,\r\n        layer: layer,\r\n      });\r\n      layer.addTo(this.map);\r\n    } else {\r\n      let index = 0;\r\n      for (const layer of this.layers) {\r\n        if (layer.id === layerId) {\r\n          this.map.removeLayer(layer.layer);\r\n          this.layers.splice(index, 1);\r\n          break;\r\n        }\r\n        index++;\r\n      }\r\n    }\r\n  }\r\n\r\n  // 组件销毁时调用，否则可能导致刷新空白等错误\r\n  destroy() {\r\n    this.map && this.map.remove();\r\n  }\r\n}\r\n\r\nexport default {\r\n  createMap,\r\n  createTileLayer,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}