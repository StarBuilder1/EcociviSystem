{"ast":null,"code":"import _defineProperty from \"E:/Working/IP_proj/EcociviSystem/ecosys/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport \"leaflet/dist/leaflet.css\";\nimport $L from \"leaflet\";\nimport { DataShowMap } from \"../../../utils/map\";\nimport Global from \"../views/Globel/Global\";\nimport { CalculateMoran } from \"./optionData\";\nexport class AnalyzeMap extends DataShowMap {\n  constructor(...args) {\n    super(...args);\n    //Add the Austria area data\n    _defineProperty(this, \"layerGroups\", new $L.FeatureGroup().addTo(this.map));\n  }\n  //Input the Country GeoJson\n  AddGeoJson(JsonData) {\n    let myStyle = {\n      color: \"#49494b\",\n      weight: 3,\n      opacity: 0.8\n    };\n    var Json = $L.geoJSON(JsonData, {\n      style: myStyle,\n      onEachFeature: onEachFeature\n    });\n    function onEachFeature(feature, layer) {\n      layer.on({\n        click: ClickFeature\n      });\n    }\n    // function resetHighlight(e) {\n    //   Json.resetStyle(e.target);\n    //   Global.MapClickName.length = Global.MapClickName.length - 1;\n    // }\n\n    function highlightFeature(e) {\n      var layer = e.target;\n      layer.setStyle({\n        weight: 5,\n        color: \"#666\",\n        dashArray: \"\",\n        fillOpacity: 0.7\n      });\n      if (!$L.Browser.ie && !$L.Browser.opera && !$L.Browser.edge) {\n        layer.bringToFront();\n      }\n    }\n    function ClickFeature(e) {\n      //get the country's name\n      if (JudgeFunction(e.target.feature.properties.name)) {\n        Json.resetStyle(e.target);\n        Global.MapClickName.length = Global.MapClickName.length - 1;\n      } else {\n        highlightFeature(e);\n        Global.MapClickName[Global.MapClickName.length] = e.target.feature.properties.name;\n        //console.log(Global.MapClickName[Global.MapClickName.length - 1]);\n        //All selected results\n        for (let i = 0; i < Global.MapClickName.length; i++) {\n          console.log(Global.MapClickName[i]);\n        }\n      }\n    }\n    this.layerGroups.addLayer(Json);\n\n    //判断这个Name是否在数组中\n    function JudgeFunction(JsonName) {\n      var state = 0;\n      for (let i = 0; i < Global.MapClickName.length; i++) {\n        if (Global.MapClickName[i] == JsonName) {\n          state = 1;\n        }\n      }\n      return state;\n    }\n  }\n\n  //清除图层\n  RemoveJson() {\n    this.layerGroups.clearLayers();\n  }\n\n  //可视化图层数据\n  VisualGeoJson(ResultJsonData, IndexName) {\n    let ResultJson = $L.geoJSON(ResultJsonData, {\n      style: style,\n      onEachFeature: onEachFeature\n    });\n    this.layerGroups.addLayer(ResultJson);\n    //分级色彩化\n    function style(feature) {\n      return {\n        fillColor: getColor(ReturnAttribute(feature, IndexName)),\n        weight: 2,\n        opacity: 1,\n        color: \"white\",\n        dashArray: \"3\",\n        fillOpacity: 0.7\n      };\n    }\n    function ReturnAttribute(feature, indexName) {\n      let Data = 0;\n      for (let i = 0; i < feature.properties.Table.length; i++) {\n        if (feature.properties.Table[i].Name == indexName) {\n          Data = feature.properties.Table[i].NameData;\n        }\n      }\n      return Data;\n    }\n    function getColor(d) {\n      return d > 75 ? \"#90EE90\" : d > 50 ? \"#FFEDA0\" : d > 25 ? \"#FEB24C\" : \"#E31A1C\";\n    }\n    //点击触发事件\n    function onEachFeature(feature, layer) {\n      let data = ReturnAttribute(feature, IndexName);\n      let popupContent = feature.properties.name + IndexName + \":\" + data;\n      layer.bindPopup(popupContent);\n    }\n  }\n\n  //Moran局部指数计算图层数据\n  MoranGeoJson(ResultJsonData, IndexName) {\n    let MoranJson = $L.geoJSON(ResultJsonData, {\n      style: style,\n      onEachFeature: onEachFeature\n    });\n    this.layerGroups.addLayer(MoranJson);\n    //分级色彩化\n    function style(feature) {\n      return {\n        fillColor: getColor(ReturnAttribute(feature, IndexName)),\n        weight: 2,\n        opacity: 1,\n        color: \"white\",\n        dashArray: \"3\",\n        fillOpacity: 0.7\n      };\n    }\n    function ReturnAttribute(feature, indexName) {\n      let Data = 0;\n      for (let i = 0; i < feature.properties.Table.length; i++) {\n        if (feature.properties.Table[i].Name == indexName) {\n          Data = feature.properties.Table[i].NameData;\n        }\n      }\n      return Data;\n    }\n    function getColor(d) {\n      return d > 75 ? \"#90EE90\" : d > 50 ? \"#FFEDA0\" : d > 25 ? \"#FEB24C\" : \"#E31A1C\";\n    }\n    //点击触发事件\n    function onEachFeature(feature, layer) {\n      let data = CalculateMoran(feature, ResultJsonData, IndexName);\n      let popupContent = feature.properties.name + \"的\" + IndexName + \" \" + data;\n      layer.bindPopup(popupContent);\n    }\n  }\n}","map":{"version":3,"names":["$L","DataShowMap","Global","CalculateMoran","AnalyzeMap","constructor","args","_defineProperty","FeatureGroup","addTo","map","AddGeoJson","JsonData","myStyle","color","weight","opacity","Json","geoJSON","style","onEachFeature","feature","layer","on","click","ClickFeature","highlightFeature","e","target","setStyle","dashArray","fillOpacity","Browser","ie","opera","edge","bringToFront","JudgeFunction","properties","name","resetStyle","MapClickName","length","i","console","log","layerGroups","addLayer","JsonName","state","RemoveJson","clearLayers","VisualGeoJson","ResultJsonData","IndexName","ResultJson","fillColor","getColor","ReturnAttribute","indexName","Data","Table","Name","NameData","d","data","popupContent","bindPopup","MoranGeoJson","MoranJson"],"sources":["E:/Working/IP_proj/EcociviSystem/ecosys/src/views/EvaluateAnalyze/js/AnalyzeMap.js"],"sourcesContent":["import \"leaflet/dist/leaflet.css\";\r\nimport $L from \"leaflet\";\r\nimport { DataShowMap } from \"../../../utils/map\";\r\nimport Global from \"../views/Globel/Global\";\r\nimport { CalculateMoran } from \"./optionData\";\r\n\r\nexport class AnalyzeMap extends DataShowMap {\r\n  //Add the Austria area data\r\n  layerGroups = new $L.FeatureGroup().addTo(this.map);\r\n\r\n  //Input the Country GeoJson\r\n  AddGeoJson(JsonData) {\r\n    let myStyle = {\r\n      color: \"#49494b\",\r\n      weight: 3,\r\n      opacity: 0.8,\r\n    };\r\n\r\n    var Json = $L.geoJSON(JsonData, {\r\n      style: myStyle,\r\n      onEachFeature: onEachFeature,\r\n    });\r\n\r\n    function onEachFeature(feature, layer) {\r\n      layer.on({\r\n        click: ClickFeature,\r\n      });\r\n    }\r\n    // function resetHighlight(e) {\r\n    //   Json.resetStyle(e.target);\r\n    //   Global.MapClickName.length = Global.MapClickName.length - 1;\r\n    // }\r\n\r\n    function highlightFeature(e) {\r\n      var layer = e.target;\r\n\r\n      layer.setStyle({\r\n        weight: 5,\r\n        color: \"#666\",\r\n        dashArray: \"\",\r\n        fillOpacity: 0.7,\r\n      });\r\n\r\n      if (!$L.Browser.ie && !$L.Browser.opera && !$L.Browser.edge) {\r\n        layer.bringToFront();\r\n      }\r\n    }\r\n    function ClickFeature(e) {\r\n      //get the country's name\r\n      if (JudgeFunction(e.target.feature.properties.name)) {\r\n        Json.resetStyle(e.target);\r\n        Global.MapClickName.length = Global.MapClickName.length - 1;\r\n      } else {\r\n        highlightFeature(e);\r\n        Global.MapClickName[Global.MapClickName.length] =\r\n          e.target.feature.properties.name;\r\n        //console.log(Global.MapClickName[Global.MapClickName.length - 1]);\r\n        //All selected results\r\n        for (let i = 0; i < Global.MapClickName.length; i++) {\r\n          console.log(Global.MapClickName[i]);\r\n        }\r\n      }\r\n    }\r\n    this.layerGroups.addLayer(Json);\r\n\r\n    //判断这个Name是否在数组中\r\n    function JudgeFunction(JsonName) {\r\n      var state = 0;\r\n      for (let i = 0; i < Global.MapClickName.length; i++) {\r\n        if (Global.MapClickName[i] == JsonName) {\r\n          state = 1;\r\n        }\r\n      }\r\n      return state;\r\n    }\r\n  }\r\n\r\n  //清除图层\r\n  RemoveJson() {\r\n    this.layerGroups.clearLayers();\r\n  }\r\n\r\n  //可视化图层数据\r\n  VisualGeoJson(ResultJsonData, IndexName) {\r\n    let ResultJson = $L.geoJSON(ResultJsonData, {\r\n      style: style,\r\n      onEachFeature: onEachFeature,\r\n    });\r\n    this.layerGroups.addLayer(ResultJson);\r\n    //分级色彩化\r\n    function style(feature) {\r\n      return {\r\n        fillColor: getColor(ReturnAttribute(feature, IndexName)),\r\n        weight: 2,\r\n        opacity: 1,\r\n        color: \"white\",\r\n        dashArray: \"3\",\r\n        fillOpacity: 0.7,\r\n      };\r\n    }\r\n    function ReturnAttribute(feature, indexName) {\r\n      let Data = 0;\r\n      for (let i = 0; i < feature.properties.Table.length; i++) {\r\n        if (feature.properties.Table[i].Name == indexName) {\r\n          Data = feature.properties.Table[i].NameData;\r\n        }\r\n      }\r\n      return Data;\r\n    }\r\n    function getColor(d) {\r\n      return d > 75\r\n        ? \"#90EE90\"\r\n        : d > 50\r\n        ? \"#FFEDA0\"\r\n        : d > 25\r\n        ? \"#FEB24C\"\r\n        : \"#E31A1C\";\r\n    }\r\n    //点击触发事件\r\n    function onEachFeature(feature, layer) {\r\n      let data = ReturnAttribute(feature, IndexName);\r\n      let popupContent = feature.properties.name + IndexName + \":\" + data;\r\n      layer.bindPopup(popupContent);\r\n    }\r\n  }\r\n\r\n  //Moran局部指数计算图层数据\r\n  MoranGeoJson(ResultJsonData, IndexName) {\r\n    let MoranJson = $L.geoJSON(ResultJsonData, {\r\n      style: style,\r\n      onEachFeature: onEachFeature,\r\n    });\r\n    this.layerGroups.addLayer(MoranJson);\r\n    //分级色彩化\r\n    function style(feature) {\r\n      return {\r\n        fillColor: getColor(ReturnAttribute(feature, IndexName)),\r\n        weight: 2,\r\n        opacity: 1,\r\n        color: \"white\",\r\n        dashArray: \"3\",\r\n        fillOpacity: 0.7,\r\n      };\r\n    }\r\n    function ReturnAttribute(feature, indexName) {\r\n      let Data = 0;\r\n      for (let i = 0; i < feature.properties.Table.length; i++) {\r\n        if (feature.properties.Table[i].Name == indexName) {\r\n          Data = feature.properties.Table[i].NameData;\r\n        }\r\n      }\r\n      return Data;\r\n    }\r\n    function getColor(d) {\r\n      return d > 75\r\n        ? \"#90EE90\"\r\n        : d > 50\r\n        ? \"#FFEDA0\"\r\n        : d > 25\r\n        ? \"#FEB24C\"\r\n        : \"#E31A1C\";\r\n    }\r\n    //点击触发事件\r\n    function onEachFeature(feature, layer) {\r\n      let data = CalculateMoran(feature, ResultJsonData, IndexName);\r\n      let popupContent =\r\n        feature.properties.name + \"的\" + IndexName + \" \" + data;\r\n      layer.bindPopup(popupContent);\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}